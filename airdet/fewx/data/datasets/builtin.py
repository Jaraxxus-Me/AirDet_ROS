import os
from .register_subt import register_subt_instances
from .register_coco import register_coco_instances
from .register_pascal_voc import register_voc_instances
from detectron2.data.datasets.builtin_meta import _get_builtin_metadata

# ==== Predefined datasets and splits for COCO ==========

_PREDEFINED_SPLITS_COCO = {}
_PREDEFINED_SPLITS_COCO["coco"] = {
    "coco_2017_train_nonvoc": ("coco/train2017", "coco/new_annotations/final_split_non_voc_instances_train2017.json"),
    "coco_2017_train_voc_10_shot": ("coco/train2017", "coco/new_annotations/final_split_voc_10_shot_instances_train2017.json"),
}
# ==== Predefined datasets and splits for SUBT ==========
_PREDEFINED_SPLITS_SUBT = {}
_PREDEFINED_SPLITS_SUBT["subt"] = {'val_f_19': ('val_f_19/JPEGImages', 'val_f_19/new_annotations/val_f_19.json'), 'val_h_14': ('val_h_14/JPEGImages', 'val_h_14/new_annotations/val_h_14.json'), 'val_g_5': ('val_g_5/JPEGImages', 'val_g_5/new_annotations/val_g_5.json'), 'val_a_4': ('val_a_4/JPEGImages', 'val_a_4/new_annotations/val_a_4.json'), 'val_e_0': ('val_e_0/JPEGImages', 'val_e_0/new_annotations/val_e_0.json'), 'val_f_1': ('val_f_1/JPEGImages', 'val_f_1/new_annotations/val_f_1.json'), 'val_f_26': ('val_f_26/JPEGImages', 'val_f_26/new_annotations/val_f_26.json'), 'val_h_55': ('val_h_55/JPEGImages', 'val_h_55/new_annotations/val_h_55.json'), 'val_g_110': ('val_g_110/JPEGImages', 'val_g_110/new_annotations/val_g_110.json'), 'val_h_2': ('val_h_2/JPEGImages', 'val_h_2/new_annotations/val_h_2.json'), 'val_h_52': ('val_h_52/JPEGImages', 'val_h_52/new_annotations/val_h_52.json'), 'val_f_5': ('val_f_5/JPEGImages', 'val_f_5/new_annotations/val_f_5.json'), 'val_g_86': ('val_g_86/JPEGImages', 'val_g_86/new_annotations/val_g_86.json'), 'val_f_2': ('val_f_2/JPEGImages', 'val_f_2/new_annotations/val_f_2.json'), 'val_h_16': ('val_h_16/JPEGImages', 'val_h_16/new_annotations/val_h_16.json'), 'val_g_103': ('val_g_103/JPEGImages', 'val_g_103/new_annotations/val_g_103.json'), 'val_f_16': ('val_f_16/JPEGImages', 'val_f_16/new_annotations/val_f_16.json'), 'val_h_46': ('val_h_46/JPEGImages', 'val_h_46/new_annotations/val_h_46.json'), 'val_g_122': ('val_g_122/JPEGImages', 'val_g_122/new_annotations/val_g_122.json'), 'val_g_62': ('val_g_62/JPEGImages', 'val_g_62/new_annotations/val_g_62.json'), 'val_g_123': ('val_g_123/JPEGImages', 'val_g_123/new_annotations/val_g_123.json'), 'val_h_18': ('val_h_18/JPEGImages', 'val_h_18/new_annotations/val_h_18.json'), 'val_f_23': ('val_f_23/JPEGImages', 'val_f_23/new_annotations/val_f_23.json'), 'val_g_70': ('val_g_70/JPEGImages', 'val_g_70/new_annotations/val_g_70.json'), 'val_g_119': ('val_g_119/JPEGImages', 'val_g_119/new_annotations/val_g_119.json'), 'val_e_5': ('val_e_5/JPEGImages', 'val_e_5/new_annotations/val_e_5.json'), 'val_f_22': ('val_f_22/JPEGImages', 'val_f_22/new_annotations/val_f_22.json'), 'val_g_98': ('val_g_98/JPEGImages', 'val_g_98/new_annotations/val_g_98.json'), 'val_g_22': ('val_g_22/JPEGImages', 'val_g_22/new_annotations/val_g_22.json'), 'val_g_75': ('val_g_75/JPEGImages', 'val_g_75/new_annotations/val_g_75.json'), 'val_g_43': ('val_g_43/JPEGImages', 'val_g_43/new_annotations/val_g_43.json'), 'val_c_11': ('val_c_11/JPEGImages', 'val_c_11/new_annotations/val_c_11.json'), 'val_g_120': ('val_g_120/JPEGImages', 'val_g_120/new_annotations/val_g_120.json'), 'val_h_15': ('val_h_15/JPEGImages', 'val_h_15/new_annotations/val_h_15.json'), 'val_g_11': ('val_g_11/JPEGImages', 'val_g_11/new_annotations/val_g_11.json'), 'val_g_4': ('val_g_4/JPEGImages', 'val_g_4/new_annotations/val_g_4.json'), 'val_h_53': ('val_h_53/JPEGImages', 'val_h_53/new_annotations/val_h_53.json'), 'val_g_84': ('val_g_84/JPEGImages', 'val_g_84/new_annotations/val_g_84.json'), 'val_g_93': ('val_g_93/JPEGImages', 'val_g_93/new_annotations/val_g_93.json'), 'val_g_12': ('val_g_12/JPEGImages', 'val_g_12/new_annotations/val_g_12.json'), 'val_g_16': ('val_g_16/JPEGImages', 'val_g_16/new_annotations/val_g_16.json'), 'val_g_79': ('val_g_79/JPEGImages', 'val_g_79/new_annotations/val_g_79.json'), 'val_g_78': ('val_g_78/JPEGImages', 'val_g_78/new_annotations/val_g_78.json'), 'val_f_6': ('val_f_6/JPEGImages', 'val_f_6/new_annotations/val_f_6.json'), 'val_g_51': ('val_g_51/JPEGImages', 'val_g_51/new_annotations/val_g_51.json'), 'val_h_42': ('val_h_42/JPEGImages', 'val_h_42/new_annotations/val_h_42.json'), 'val_h_59': ('val_h_59/JPEGImages', 'val_h_59/new_annotations/val_h_59.json'), 'val_g_72': ('val_g_72/JPEGImages', 'val_g_72/new_annotations/val_g_72.json'), 'val_g_44': ('val_g_44/JPEGImages', 'val_g_44/new_annotations/val_g_44.json'), 'val_g_85': ('val_g_85/JPEGImages', 'val_g_85/new_annotations/val_g_85.json'), 'val_f_4': ('val_f_4/JPEGImages', 'val_f_4/new_annotations/val_f_4.json'), 'val_g_14': ('val_g_14/JPEGImages', 'val_g_14/new_annotations/val_g_14.json'), 'val_g_15': ('val_g_15/JPEGImages', 'val_g_15/new_annotations/val_g_15.json'), 'val_g_2': ('val_g_2/JPEGImages', 'val_g_2/new_annotations/val_g_2.json'), 'val_g_55': ('val_g_55/JPEGImages', 'val_g_55/new_annotations/val_g_55.json'), 'val_g_68': ('val_g_68/JPEGImages', 'val_g_68/new_annotations/val_g_68.json'), 'val_g_45': ('val_g_45/JPEGImages', 'val_g_45/new_annotations/val_g_45.json'), 'val_h_38': ('val_h_38/JPEGImages', 'val_h_38/new_annotations/val_h_38.json'), 'val_h_6': ('val_h_6/JPEGImages', 'val_h_6/new_annotations/val_h_6.json'), 'val_g_0': ('val_g_0/JPEGImages', 'val_g_0/new_annotations/val_g_0.json'), 'val_f_24': ('val_f_24/JPEGImages', 'val_f_24/new_annotations/val_f_24.json'), 'val_h_34': ('val_h_34/JPEGImages', 'val_h_34/new_annotations/val_h_34.json'), 'val_g_61': ('val_g_61/JPEGImages', 'val_g_61/new_annotations/val_g_61.json'), 'val_h_50': ('val_h_50/JPEGImages', 'val_h_50/new_annotations/val_h_50.json'), 'val_e_12': ('val_e_12/JPEGImages', 'val_e_12/new_annotations/val_e_12.json'), 'val_f_20': ('val_f_20/JPEGImages', 'val_f_20/new_annotations/val_f_20.json'), 'val_f_0': ('val_f_0/JPEGImages', 'val_f_0/new_annotations/val_f_0.json'), 'val_g_9': ('val_g_9/JPEGImages', 'val_g_9/new_annotations/val_g_9.json'), 'val_h_10': ('val_h_10/JPEGImages', 'val_h_10/new_annotations/val_h_10.json'), 'val_h_33': ('val_h_33/JPEGImages', 'val_h_33/new_annotations/val_h_33.json'), 'val_a_0': ('val_a_0/JPEGImages', 'val_a_0/new_annotations/val_a_0.json'), 'val_h_8': ('val_h_8/JPEGImages', 'val_h_8/new_annotations/val_h_8.json'), 'val_g_101': ('val_g_101/JPEGImages', 'val_g_101/new_annotations/val_g_101.json'), 'val_f_28': ('val_f_28/JPEGImages', 'val_f_28/new_annotations/val_f_28.json'), 'val_g_39': ('val_g_39/JPEGImages', 'val_g_39/new_annotations/val_g_39.json'), 'val_g_88': ('val_g_88/JPEGImages', 'val_g_88/new_annotations/val_g_88.json'), 'val_g_60': ('val_g_60/JPEGImages', 'val_g_60/new_annotations/val_g_60.json'), 'val_g_105': ('val_g_105/JPEGImages', 'val_g_105/new_annotations/val_g_105.json'), 'val_e_4': ('val_e_4/JPEGImages', 'val_e_4/new_annotations/val_e_4.json'), 'val_h_57': ('val_h_57/JPEGImages', 'val_h_57/new_annotations/val_h_57.json'), 'val_g_7': ('val_g_7/JPEGImages', 'val_g_7/new_annotations/val_g_7.json'), 'val_f_25': ('val_f_25/JPEGImages', 'val_f_25/new_annotations/val_f_25.json'), 'val_c_1': ('val_c_1/JPEGImages', 'val_c_1/new_annotations/val_c_1.json'), 'val_e_2': ('val_e_2/JPEGImages', 'val_e_2/new_annotations/val_e_2.json'), 'val_h_41': ('val_h_41/JPEGImages', 'val_h_41/new_annotations/val_h_41.json'), 'val_g_126': ('val_g_126/JPEGImages', 'val_g_126/new_annotations/val_g_126.json'), 'val_f_17': ('val_f_17/JPEGImages', 'val_f_17/new_annotations/val_f_17.json'), 'val_f_12': ('val_f_12/JPEGImages', 'val_f_12/new_annotations/val_f_12.json'), 'val_h_11': ('val_h_11/JPEGImages', 'val_h_11/new_annotations/val_h_11.json'), 'val_c_0': ('val_c_0/JPEGImages', 'val_c_0/new_annotations/val_c_0.json'), 'val_g_99': ('val_g_99/JPEGImages', 'val_g_99/new_annotations/val_g_99.json'), 'val_h_17': ('val_h_17/JPEGImages', 'val_h_17/new_annotations/val_h_17.json'), 'val_f_14': ('val_f_14/JPEGImages', 'val_f_14/new_annotations/val_f_14.json'), 'val_g_34': ('val_g_34/JPEGImages', 'val_g_34/new_annotations/val_g_34.json'), 'val_a_1': ('val_a_1/JPEGImages', 'val_a_1/new_annotations/val_a_1.json'), 'val_g_52': ('val_g_52/JPEGImages', 'val_g_52/new_annotations/val_g_52.json'), 'val_g_66': ('val_g_66/JPEGImages', 'val_g_66/new_annotations/val_g_66.json'), 'val_e_11': ('val_e_11/JPEGImages', 'val_e_11/new_annotations/val_e_11.json'), 'val_g_134': ('val_g_134/JPEGImages', 'val_g_134/new_annotations/val_g_134.json'), 'val_g_42': ('val_g_42/JPEGImages', 'val_g_42/new_annotations/val_g_42.json'), 'val_g_121': ('val_g_121/JPEGImages', 'val_g_121/new_annotations/val_g_121.json'), 'val_f_11': ('val_f_11/JPEGImages', 'val_f_11/new_annotations/val_f_11.json'), 'val_g_131': ('val_g_131/JPEGImages', 'val_g_131/new_annotations/val_g_131.json'), 'val_h_54': ('val_h_54/JPEGImages', 'val_h_54/new_annotations/val_h_54.json'), 'val_g_21': ('val_g_21/JPEGImages', 'val_g_21/new_annotations/val_g_21.json'), 'val_f_18': ('val_f_18/JPEGImages', 'val_f_18/new_annotations/val_f_18.json'), 'val_g_133': ('val_g_133/JPEGImages', 'val_g_133/new_annotations/val_g_133.json'), 'val_g_64': ('val_g_64/JPEGImages', 'val_g_64/new_annotations/val_g_64.json'), 'val_g_73': ('val_g_73/JPEGImages', 'val_g_73/new_annotations/val_g_73.json'), 'val_g_130': ('val_g_130/JPEGImages', 'val_g_130/new_annotations/val_g_130.json'), 'val_g_54': ('val_g_54/JPEGImages', 'val_g_54/new_annotations/val_g_54.json'), 'val_g_112': ('val_g_112/JPEGImages', 'val_g_112/new_annotations/val_g_112.json'), 'val_f_10': ('val_f_10/JPEGImages', 'val_f_10/new_annotations/val_f_10.json'), 'val_g_38': ('val_g_38/JPEGImages', 'val_g_38/new_annotations/val_g_38.json'), 'val_g_100': ('val_g_100/JPEGImages', 'val_g_100/new_annotations/val_g_100.json'), 'val_g_128': ('val_g_128/JPEGImages', 'val_g_128/new_annotations/val_g_128.json'), 'val_g_23': ('val_g_23/JPEGImages', 'val_g_23/new_annotations/val_g_23.json'), 'val_h_28': ('val_h_28/JPEGImages', 'val_h_28/new_annotations/val_h_28.json'), 'val_g_8': ('val_g_8/JPEGImages', 'val_g_8/new_annotations/val_g_8.json'), 'val_b_4': ('val_b_4/JPEGImages', 'val_b_4/new_annotations/val_b_4.json'), 'val_g_35': ('val_g_35/JPEGImages', 'val_g_35/new_annotations/val_g_35.json'), 'val_g_37': ('val_g_37/JPEGImages', 'val_g_37/new_annotations/val_g_37.json'), 'val_h_3': ('val_h_3/JPEGImages', 'val_h_3/new_annotations/val_h_3.json'), 'val_g_29': ('val_g_29/JPEGImages', 'val_g_29/new_annotations/val_g_29.json'), 'val_c_6': ('val_c_6/JPEGImages', 'val_c_6/new_annotations/val_c_6.json'), 'val_g_28': ('val_g_28/JPEGImages', 'val_g_28/new_annotations/val_g_28.json'), 'val_e_3': ('val_e_3/JPEGImages', 'val_e_3/new_annotations/val_e_3.json'), 'val_h_26': ('val_h_26/JPEGImages', 'val_h_26/new_annotations/val_h_26.json'), 'val_h_9': ('val_h_9/JPEGImages', 'val_h_9/new_annotations/val_h_9.json'), 'val_g_97': ('val_g_97/JPEGImages', 'val_g_97/new_annotations/val_g_97.json'), 'val_g_90': ('val_g_90/JPEGImages', 'val_g_90/new_annotations/val_g_90.json'), 'val_g_132': ('val_g_132/JPEGImages', 'val_g_132/new_annotations/val_g_132.json'), 'val_g_46': ('val_g_46/JPEGImages', 'val_g_46/new_annotations/val_g_46.json'), 'val_h_20': ('val_h_20/JPEGImages', 'val_h_20/new_annotations/val_h_20.json'), 'val_g_63': ('val_g_63/JPEGImages', 'val_g_63/new_annotations/val_g_63.json'), 'val_f_9': ('val_f_9/JPEGImages', 'val_f_9/new_annotations/val_f_9.json'), 'val_g_59': ('val_g_59/JPEGImages', 'val_g_59/new_annotations/val_g_59.json'), 'val_g_3': ('val_g_3/JPEGImages', 'val_g_3/new_annotations/val_g_3.json'), 'val_h_1': ('val_h_1/JPEGImages', 'val_h_1/new_annotations/val_h_1.json'), 'val_a_5': ('val_a_5/JPEGImages', 'val_a_5/new_annotations/val_a_5.json'), 'val_e_7': ('val_e_7/JPEGImages', 'val_e_7/new_annotations/val_e_7.json'), 'val_g_49': ('val_g_49/JPEGImages', 'val_g_49/new_annotations/val_g_49.json'), 'val_f_13': ('val_f_13/JPEGImages', 'val_f_13/new_annotations/val_f_13.json'), 'val_f_27': ('val_f_27/JPEGImages', 'val_f_27/new_annotations/val_f_27.json'), 'val_g_117': ('val_g_117/JPEGImages', 'val_g_117/new_annotations/val_g_117.json'), 'val_g_81': ('val_g_81/JPEGImages', 'val_g_81/new_annotations/val_g_81.json'), 'val_e_13': ('val_e_13/JPEGImages', 'val_e_13/new_annotations/val_e_13.json'), 'val_e_6': ('val_e_6/JPEGImages', 'val_e_6/new_annotations/val_e_6.json'), 'val_h_43': ('val_h_43/JPEGImages', 'val_h_43/new_annotations/val_h_43.json'), 'val_g_108': ('val_g_108/JPEGImages', 'val_g_108/new_annotations/val_g_108.json'), 'val_h_22': ('val_h_22/JPEGImages', 'val_h_22/new_annotations/val_h_22.json'), 'val_g_111': ('val_g_111/JPEGImages', 'val_g_111/new_annotations/val_g_111.json'), 'val_g_25': ('val_g_25/JPEGImages', 'val_g_25/new_annotations/val_g_25.json'), 'val_g_30': ('val_g_30/JPEGImages', 'val_g_30/new_annotations/val_g_30.json'), 'val_e_15': ('val_e_15/JPEGImages', 'val_e_15/new_annotations/val_e_15.json'), 'val_g_33': ('val_g_33/JPEGImages', 'val_g_33/new_annotations/val_g_33.json'), 'val_g_48': ('val_g_48/JPEGImages', 'val_g_48/new_annotations/val_g_48.json'), 'val_g_129': ('val_g_129/JPEGImages', 'val_g_129/new_annotations/val_g_129.json'), 'val_a_6': ('val_a_6/JPEGImages', 'val_a_6/new_annotations/val_a_6.json'), 'val_g_127': ('val_g_127/JPEGImages', 'val_g_127/new_annotations/val_g_127.json'), 'val_h_23': ('val_h_23/JPEGImages', 'val_h_23/new_annotations/val_h_23.json'), 'val_e_8': ('val_e_8/JPEGImages', 'val_e_8/new_annotations/val_e_8.json'), 'val_e_14': ('val_e_14/JPEGImages', 'val_e_14/new_annotations/val_e_14.json'), 'val_g_6': ('val_g_6/JPEGImages', 'val_g_6/new_annotations/val_g_6.json'), 'val_e_1': ('val_e_1/JPEGImages', 'val_e_1/new_annotations/val_e_1.json'), 'val_g_67': ('val_g_67/JPEGImages', 'val_g_67/new_annotations/val_g_67.json'), 'val_g_109': ('val_g_109/JPEGImages', 'val_g_109/new_annotations/val_g_109.json'), 'val_f_7': ('val_f_7/JPEGImages', 'val_f_7/new_annotations/val_f_7.json'), 'val_h_51': ('val_h_51/JPEGImages', 'val_h_51/new_annotations/val_h_51.json'), 'val_g_116': ('val_g_116/JPEGImages', 'val_g_116/new_annotations/val_g_116.json'), 'val_g_20': ('val_g_20/JPEGImages', 'val_g_20/new_annotations/val_g_20.json'), 'val_g_102': ('val_g_102/JPEGImages', 'val_g_102/new_annotations/val_g_102.json'), 'val_g_26': ('val_g_26/JPEGImages', 'val_g_26/new_annotations/val_g_26.json'), 'val_g_65': ('val_g_65/JPEGImages', 'val_g_65/new_annotations/val_g_65.json'), 'val_g_104': ('val_g_104/JPEGImages', 'val_g_104/new_annotations/val_g_104.json'), 'val_g_89': ('val_g_89/JPEGImages', 'val_g_89/new_annotations/val_g_89.json'), 'val_h_44': ('val_h_44/JPEGImages', 'val_h_44/new_annotations/val_h_44.json'), 'val_g_53': ('val_g_53/JPEGImages', 'val_g_53/new_annotations/val_g_53.json'), 'val_g_113': ('val_g_113/JPEGImages', 'val_g_113/new_annotations/val_g_113.json'), 'val_g_56': ('val_g_56/JPEGImages', 'val_g_56/new_annotations/val_g_56.json'), 'val_c_8': ('val_c_8/JPEGImages', 'val_c_8/new_annotations/val_c_8.json'), 'val_g_118': ('val_g_118/JPEGImages', 'val_g_118/new_annotations/val_g_118.json'), 'val_g_58': ('val_g_58/JPEGImages', 'val_g_58/new_annotations/val_g_58.json'), 'val_h_45': ('val_h_45/JPEGImages', 'val_h_45/new_annotations/val_h_45.json'), 'val_g_74': ('val_g_74/JPEGImages', 'val_g_74/new_annotations/val_g_74.json'), 'val_g_77': ('val_g_77/JPEGImages', 'val_g_77/new_annotations/val_g_77.json'), 'val_c_13': ('val_c_13/JPEGImages', 'val_c_13/new_annotations/val_c_13.json'), 'val_g_17': ('val_g_17/JPEGImages', 'val_g_17/new_annotations/val_g_17.json'), 'val_c_12': ('val_c_12/JPEGImages', 'val_c_12/new_annotations/val_c_12.json'), 'val_g_124': ('val_g_124/JPEGImages', 'val_g_124/new_annotations/val_g_124.json'), 'val_g_10': ('val_g_10/JPEGImages', 'val_g_10/new_annotations/val_g_10.json'), 'val_h_12': ('val_h_12/JPEGImages', 'val_h_12/new_annotations/val_h_12.json'), 'val_g_82': ('val_g_82/JPEGImages', 'val_g_82/new_annotations/val_g_82.json'), 'val_f_21': ('val_f_21/JPEGImages', 'val_f_21/new_annotations/val_f_21.json'), 'val_a_2': ('val_a_2/JPEGImages', 'val_a_2/new_annotations/val_a_2.json'), 'val_c_9': ('val_c_9/JPEGImages', 'val_c_9/new_annotations/val_c_9.json'), 'val_g_96': ('val_g_96/JPEGImages', 'val_g_96/new_annotations/val_g_96.json'), 'val_g_40': ('val_g_40/JPEGImages', 'val_g_40/new_annotations/val_g_40.json'), 'val_g_114': ('val_g_114/JPEGImages', 'val_g_114/new_annotations/val_g_114.json'), 'val_g_80': ('val_g_80/JPEGImages', 'val_g_80/new_annotations/val_g_80.json'), 'val_h_49': ('val_h_49/JPEGImages', 'val_h_49/new_annotations/val_h_49.json'), 'val_h_56': ('val_h_56/JPEGImages', 'val_h_56/new_annotations/val_h_56.json'), 'val_g_19': ('val_g_19/JPEGImages', 'val_g_19/new_annotations/val_g_19.json'), 'val_g_27': ('val_g_27/JPEGImages', 'val_g_27/new_annotations/val_g_27.json'), 'val_f_15': ('val_f_15/JPEGImages', 'val_f_15/new_annotations/val_f_15.json'), 'val_g_41': ('val_g_41/JPEGImages', 'val_g_41/new_annotations/val_g_41.json'), 'val_f_8': ('val_f_8/JPEGImages', 'val_f_8/new_annotations/val_f_8.json'), 'val_b_2': ('val_b_2/JPEGImages', 'val_b_2/new_annotations/val_b_2.json'), 'val_g_1': ('val_g_1/JPEGImages', 'val_g_1/new_annotations/val_g_1.json'), 'val_h_4': ('val_h_4/JPEGImages', 'val_h_4/new_annotations/val_h_4.json'), 'val_h_5': ('val_h_5/JPEGImages', 'val_h_5/new_annotations/val_h_5.json'), 'val_g_107': ('val_g_107/JPEGImages', 'val_g_107/new_annotations/val_g_107.json'), 'val_g_47': ('val_g_47/JPEGImages', 'val_g_47/new_annotations/val_g_47.json'), 'val_g_125': ('val_g_125/JPEGImages', 'val_g_125/new_annotations/val_g_125.json'), 'val_g_36': ('val_g_36/JPEGImages', 'val_g_36/new_annotations/val_g_36.json'), 'val_d_0': ('val_d_0/JPEGImages', 'val_d_0/new_annotations/val_d_0.json'), 'val_b_1': ('val_b_1/JPEGImages', 'val_b_1/new_annotations/val_b_1.json'), 'val_h_13': ('val_h_13/JPEGImages', 'val_h_13/new_annotations/val_h_13.json'), 'val_g_50': ('val_g_50/JPEGImages', 'val_g_50/new_annotations/val_g_50.json'), 'val_h_58': ('val_h_58/JPEGImages', 'val_h_58/new_annotations/val_h_58.json'), 'val_f_29': ('val_f_29/JPEGImages', 'val_f_29/new_annotations/val_f_29.json'), 'val_g_13': ('val_g_13/JPEGImages', 'val_g_13/new_annotations/val_g_13.json'), 'val_h_47': ('val_h_47/JPEGImages', 'val_h_47/new_annotations/val_h_47.json'), 'val_f_3': ('val_f_3/JPEGImages', 'val_f_3/new_annotations/val_f_3.json'), 'val_e_9': ('val_e_9/JPEGImages', 'val_e_9/new_annotations/val_e_9.json'), 'val_h_48': ('val_h_48/JPEGImages', 'val_h_48/new_annotations/val_h_48.json'), 'val_g_83': ('val_g_83/JPEGImages', 'val_g_83/new_annotations/val_g_83.json'), 'val_h_35': ('val_h_35/JPEGImages', 'val_h_35/new_annotations/val_h_35.json'), 'val_a_3': ('val_a_3/JPEGImages', 'val_a_3/new_annotations/val_a_3.json'), 'val_g_32': ('val_g_32/JPEGImages', 'val_g_32/new_annotations/val_g_32.json'), 'val_e_10': ('val_e_10/JPEGImages', 'val_e_10/new_annotations/val_e_10.json'), 'val_g_71': ('val_g_71/JPEGImages', 'val_g_71/new_annotations/val_g_71.json'), 'val_b_3': ('val_b_3/JPEGImages', 'val_b_3/new_annotations/val_b_3.json'), 'val_g_24': ('val_g_24/JPEGImages', 'val_g_24/new_annotations/val_g_24.json')}

# ==== Predefined datasets and splits for Pascal VOC ==========

_PREDEFINED_SPLITS_PASCAL = {}
_PREDEFINED_SPLITS_PASCAL["pascal_voc"] = {
    "voc_2012_train_1": ("voc/JPEGImages", "voc/new_annotations/voc2012_1_shot_val.json"),
    "voc_2012_train_2": ("voc/JPEGImages", "voc/new_annotations/voc2012_2_shot_val.json"),
    "voc_2012_validation": ("voc/JPEGImages","voc/annotations/pascal_val2012.json"),
}

def register_all_coco(root):
    for dataset_name, splits_per_dataset in _PREDEFINED_SPLITS_COCO.items():
        for key, (image_root, json_file) in splits_per_dataset.items():
            # Assume pre-defined datasets live in `./datasets`.
            register_coco_instances(
                key,
                _get_builtin_metadata(dataset_name),
                os.path.join(root, json_file) if "://" not in json_file else json_file,
                os.path.join(root, image_root),
            )

def register_all_subt(root):
    root_path = os.path.join(root, 'SUBT', 'use')
    for dataset_name, splits_per_dataset in _PREDEFINED_SPLITS_SUBT.items():
        for key, (image_root, json_file) in splits_per_dataset.items():
            # Assume pre-defined datasets live in `./datasets`.
            register_subt_instances(name=key,
                                    json_file=os.path.join(root_path, json_file) if "://" not in json_file else json_file,
                                    image_root=os.path.join(root_path, image_root),)

def register_all_voc(root):
    for dataset_name, splits_per_dataset in _PREDEFINED_SPLITS_PASCAL.items():
        for key, (image_root, json_file) in splits_per_dataset.items():
            # Assume pre-defined datasets live in `./datasets`.
            register_voc_instances(name=key,
                                    json_file=os.path.join(root, json_file) if "://" not in json_file else json_file,
                                    image_root=os.path.join(root, image_root),)

# Register them all under "./datasets"
_root = os.getenv("DETECTRON2_DATASETS", "datasets")
register_all_coco(_root)
register_all_subt(_root)
register_all_voc(_root)